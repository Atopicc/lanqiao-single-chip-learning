C51 COMPILER V9.54   AIE                                                                   06/12/2023 18:43:36 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE AIE
OBJECT MODULE PLACED IN .\Objects\AIE.obj
COMPILER INVOKED BY: D:\keil\C51\BIN\C51.EXE AIE.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\AIE.lst)
                    - OBJECT(.\Objects\AIE.obj)

line level    source

   1          #include "stc15f2k60s2.h"
   2          #include "absacc.h"
   3          
   4          // å®šä¹‰å¸¸é‡å’Œç±»å‹
   5          #define uint unsigned int
   6          #define uchar unsigned char
   7          #define LED_ADDR 0X8000 // LEDçš„MMæ¨¡å¼åœ°å€
   8          #define EXTDEV_ADDR 0XA000 // å¤–éƒ¨è®¾å¤‡çš„MMæ¨¡å¼åœ°å€
   9          #define MODE_IO 0 // IOæ¨¡å¼æ ‡å¿—
  10          #define MODE_MM 1 // MMæ¨¡å¼æ ‡å¿—
  11          
  12          // å£°æ˜å‡½æ•°
  13          void externaldevice(unsigned char beepdata,unsigned char relaydata, unsigned char mode);// æ§åˆ¶å¤–éƒ¨è®¾
             -å¤‡ï¼ˆèœ‚é¸£å™¨ã€ç»§ç”µå™¨ï¼‰
  14          void delay_ms(unsigned int delaydata);// å»¶æ—¶å‡½æ•°
  15          void LED(unsigned char LEDdata, unsigned char mode);// æ§åˆ¶LED
  16          
  17          // ä¸»å‡½æ•°
  18          void main()
  19          {
  20   1        unsigned char i=0;
  21   1        externaldevice(0,0,MODE_MM); // ä½¿ç”¨MMæ¨¡å¼æ§åˆ¶å¤–éƒ¨è®¾å¤‡
  22   1        // å®ç°ä»¥ç§’ä¸ºé—´éš”ï¼ŒLEDæµæ°´ç¯çš„æ•ˆæœ
  23   1        while(1)
  24   1        {
  25   2          LED(~(0x0c<<i),MODE_MM); // ä½¿ç”¨MMæ¨¡å¼æ§åˆ¶LED
  26   2          delay_ms(600);
  27   2          i++;
  28   2          if(i>=8)
  29   2          i=0;
  30   2          
  31   2        }
  32   1      }
  33          ////////////////////////////////
  34          void externaldevice(unsigned char beepdata,unsigned char relaydata, unsigned char mode)// æ§åˆ¶å¤–éƒ¨è®¾å
             -¤‡ï¼ˆèœ‚é¸£å™¨ã€ç»§ç”µå™¨ï¼‰
  35          {
  36   1        unsigned char extdev_data=0;
  37   1        if(beepdata) extdev_data|=0X40; // å¦‚æœèœ‚é¸£å™¨æ•°æ®ä¸º1ï¼Œè®¾ç½®ç›¸åº”çš„ä½
  38   1        if(relaydata) extdev_data|=0X10; // å¦‚æœç»§ç”µå™¨æ•°æ®ä¸º1ï¼Œè®¾ç½®ç›¸åº”çš„ä½
  39   1        EA = 0;// å…³é—­ä¸­æ–­æ€»ä½¿èƒ½
  40   1        if(mode == MODE_IO) // ä½¿ç”¨IOæ¨¡å¼
  41   1        {
  42   2          P0 = extdev_data; // å°†æ•°æ®é€åˆ°P0å£
  43   2          P2 = (P2 & 0X1F)|0XA0;// è®©138è¯‘ç å™¨çš„CBAä¸º5ï¼ŒY5è¾“å‡ºä½ç”µå¹³ï¼Œ573çš„LEä¸ºé«˜é”å­˜çŠ¶æ€è§£
             -é™¤
  44   2          P0 = extdev_data; // å†æ¬¡å°†æ•°æ®é€åˆ°P0å£ï¼Œé”å­˜åˆ°573ä¸­
  45   2          P2 &= 0X1F;// é”å­˜æ•°æ®
  46   2        }
  47   1        else if(mode == MODE_MM) // ä½¿ç”¨MMæ¨¡å¼
  48   1        {
  49   2          XBYTE[EXTDEV_ADDR] = extdev_data; // ç›´æ¥è®¿é—®å¤–éƒ¨è®¾å¤‡çš„åœ°å€ï¼Œå†™å…¥æ•°æ®
  50   2          P2 &= 0X1F;// é”å­˜æ•°æ®
  51   2        }
C51 COMPILER V9.54   AIE                                                                   06/12/2023 18:43:36 PAGE 2   

  52   1        
  53   1        EA = 1;// æ‰“å¼€ä¸­æ–­æ€»ä½¿èƒ½
  54   1      }
  55          ////////////////////////////////
  56          
  57          void delay_ms(unsigned int delaydata)// å»¶æ—¶å‡½æ•°
  58          {
  59   1        unsigned int i;
  60   1        while(delaydata--)
  61   1          for(i=640;i>0;i--); // å¾ªç¯640æ¬¡å¤§çº¦å»¶æ—¶1msï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
  62   1      }
  63          
  64          /////////////////////////////
  65          void LED(unsigned char LEDdata, unsigned char mode)// æ§åˆ¶LED
  66          {
  67   1        
  68   1        EA = 0;// å…³é—­ä¸­æ–­æ€»ä½¿èƒ½
  69   1        if(mode == MODE_IO) // ä½¿ç”¨IOæ¨¡å¼
  70   1        {
  71   2          P0 = LEDdata; // å°†æ•°æ®é€åˆ°P0å£
  72   2          P2 = (P2 & 0X1F)|0X80;// è®©138è¯‘ç å™¨çš„CBAä¸º4ï¼ŒY4è¾“å‡ºä½ç”µå¹³ï¼Œ573çš„LEä¸ºé«˜é”å­˜çŠ¶æ€è§£
             -é™¤
  73   2          P0 = LEDdata; // å†æ¬¡å°†æ•°æ®é€åˆ°P0å£ï¼Œé”å­˜åˆ°573ä¸­
  74   2          P2 &= 0X1F;// é”å­˜æ•°æ®
  75   2        }
  76   1        else if(mode == MODE_MM) // ä½¿ç”¨MMæ¨¡å¼
  77   1        {
  78   2          XBYTE[LED_ADDR] = LEDdata; // ç›´æ¥è®¿é—®LEDçš„åœ°å€ï¼Œå†™å…¥æ•°æ®
  79   2          P2 &= 0X1F;// é”å­˜æ•°æ®
  80   2        }
  81   1        
  82   1        EA = 1;// æ‰“å¼€ä¸­æ–­æ€»ä½¿èƒ½
  83   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    161    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
